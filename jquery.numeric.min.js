/*
 *
 * Copyright (c) 2006-2014 Sam Collett (http://www.texotela.co.uk)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version 1.4.1
 * Demo: http://www.texotela.co.uk/code/jquery/numeric/
 *
 */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)}(function(e){e.fn.numeric=function(t,n){"boolean"==typeof t&&(t={decimal:t,negative:!0,negativeOnly:!1,decimalPlaces:-1}),void 0===(t=t||{}).negative&&(t.negative=!0);var a=!1===t.decimal?"":t.decimal||".",i=!1===t.altDecimal?"":t.altDecimal||a,r=!0===t.negative,c=!0===t.negativeOnly&&!0===r,l=void 0===t.decimalPlaces?-1:t.decimalPlaces;return n="function"==typeof n?n:function(){},this.data("numeric.decimal",a).data("numeric.negative",r).data("numeric.altDecimal",i).data("numeric.negativeOnly",c).data("numeric.callback",n).data("numeric.decimalPlaces",l).keypress(e.fn.numeric.keypress).keyup(e.fn.numeric.keyup).blur(e.fn.numeric.blur)},e.fn.numeric.keypress=function(t){var n=e.data(this,"numeric.decimal"),a=e.data(this,"numeric.negative");e.data(this,"numeric.negativeOnly");var i=e.data(this,"numeric.decimalPlaces"),r=e.data(this,"numeric.altDecimal"),c=t.charCode?t.charCode:t.keyCode?t.keyCode:0;if(13==c&&"input"==this.nodeName.toLowerCase())return!0;if(13==c||35==c||36==c||37==c)return!1;var l=!1;if(t.ctrlKey&&97==c||t.ctrlKey&&65==c||t.ctrlKey&&120==c||t.ctrlKey&&88==c||t.ctrlKey&&99==c||t.ctrlKey&&67==c||t.ctrlKey&&122==c||t.ctrlKey&&90==c||t.ctrlKey&&118==c||t.ctrlKey&&86==c||t.shiftKey&&45==c)return!0;if(c<48||c>57){var u=e(this).val();if(0!==e.inArray("-",u.split(""))&&a&&45==c&&(0===u.length||0===parseInt(e.fn.getSelectionStart(this),10)))return!0;n&&c==n.charCodeAt(0)&&-1!=e.inArray(n,u.split(""))&&(l=!1),8!=c&&9!=c&&13!=c&&35!=c&&36!=c&&37!=c&&39!=c&&46!=c?l=!1:void 0!==t.charCode&&(t.keyCode==t.which&&0!==t.which?(l=!0,46==t.which&&(l=!1)):0!==t.keyCode&&0===t.charCode&&0===t.which&&(l=!0)),(n&&c==n.charCodeAt(0)||r&&c==r.charCodeAt(0))&&(l=-1==e.inArray(n,u.split("")))}else if(l=!0,n&&i>0){var s=e.fn.getSelectionStart(this),d=e.fn.getSelectionEnd(this),m=e.inArray(n,e(this).val().split(""));s===d&&m>=0&&s>m&&e(this).val().length>m+i&&(l=!1)}return l},e.fn.numeric.keyup=function(t){var n=e(this).val();if(n&&n.length>0){var a=e.fn.getSelectionStart(this),i=e.fn.getSelectionEnd(this),r=e.data(this,"numeric.decimal"),c=e.data(this,"numeric.negative"),l=e.data(this,"numeric.negativeOnly"),u=e.data(this,"numeric.decimalPlaces"),s=e.data(this,"numeric.altDecimal");if(""!==r&&null!==r){var d=e.inArray(r,n.split(""));0===d&&(this.value="0"+n,a++,i++),1==d&&"-"==n.charAt(0)&&(this.value="-0"+n.substring(1),a++,i++),n=this.value}for(var m=[0,1,2,3,4,5,6,7,8,9,"-",r],h=n.length,o=h-1;o>=0;o--){var f=n.charAt(o);0!==o&&"-"==f?n=n.substring(0,o)+n.substring(o+1):0!==o||c||"-"!=f?0===o&&c&&l&&"-"!=f&&(n="-"+n,a++,i++):n=n.substring(1);for(var $=!1,v=0;v<m.length;v++)if(f==m[v]){$=!0;break}$||f!=s||(n=n.substring(0,o)+r+n.substring(o+1),$=!0),$&&" "!=f||(n=n.substring(0,o)+n.substring(o+1))}var g=e.inArray(r,n.split(""));if(g>0)for(var y=h-1;y>g;y--)n.charAt(y)==r&&(n=n.substring(0,y)+n.substring(y+1));if(r&&u>0){var d=e.inArray(r,n.split(""));d>=0&&(i=Math.min((n=n.substring(0,d+u+1)).length,i))}this.value=n,e.fn.setSelection(this,[a,i])}},e.fn.numeric.blur=function(){var t=e.data(this,"numeric.decimal"),n=e.data(this,"numeric.callback"),a=e.data(this,"numeric.negative"),i=e.data(this,"numeric.negativeOnly"),r=this.value;if(""!==r){let c="";a&&(c=i?"-":"-?"),RegExp("^"+c+"\\d+$|^"+c+"\\d*"+t+"\\d+$").exec(r)||n.apply(this)}},e.fn.removeNumeric=function(){return this.data("numeric.decimal",null).data("numeric.negative",null).data("numeric.negativeOnly",null).data("numeric.altDecimal",null).data("numeric.callback",null).data("numeric.decimalPlaces",null).unbind("keypress",e.fn.numeric.keypress).unbind("keyup",e.fn.numeric.keyup).unbind("blur",e.fn.numeric.blur)},e.fn.getSelectionStart=function(e){if("number"!==e.type){if(e.createTextRange&&document.selection){var t=document.selection.createRange().duplicate();return(t.moveEnd("character",e.value.length),""==t.text)?e.value.length:Math.max(0,e.value.lastIndexOf(t.text))}try{return e.selectionStart}catch(n){return 0}}},e.fn.getSelectionEnd=function(e){if("number"!==e.type){if(!e.createTextRange||!document.selection)return e.selectionEnd;var t=document.selection.createRange().duplicate();return t.moveStart("character",-e.value.length),t.text.length}},e.fn.setSelection=function(e,t){if("number"==typeof t&&(t=[t,t]),t&&t.constructor==Array&&2==t.length){if("number"===e.type)e.focus();else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveStart("character",t[0]),n.moveEnd("character",t[1]-t[0]),n.select()}else{e.focus();try{e.setSelectionRange&&e.setSelectionRange(t[0],t[1])}catch(a){}}}}});
